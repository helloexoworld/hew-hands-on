<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>Monitoring Warp&nbsp;10 using Warp&nbsp;10 - Warp10 Documentation</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon"/>
  <link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>

  <style>
    body {
      background-color: #eeeeee;
    }
  </style>


  <link rel="stylesheet" href="/assets/bootstrap.min.css">
  <link rel="stylesheet" href="/assets/font-awesome.min.css">
  <link rel="stylesheet" href="/assets/https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" />

  <script src="/assets/webcomponents-lite.js"></script>
  <script src="/assets/jquery.js"></script>
  <script src="/assets/bootstrap.js"></script>

  <link rel="import" href="/assets/warp10-components.html">

  <!--
  <script src="http://localhost:8000/bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <script src="http://localhost:8000/bower_components/jquery/dist/jquery.js"></script>
  <script src="http://localhost:8000/bower_components/bootstrap/dist/js/bootstrap.js"></script>
  <link   rel="import" href="http://localhost:8000/bower_components/polymer/polymer.html">
  <link   rel="import" href="http://localhost:8000/bower_components/warp10-navbar/warp10-navbar.html">
  <link   rel="import" href="http://localhost:8000/bower_components/warp10-quantum/warp10-conf.html">
  <link   rel="import" href="http://localhost:8000/bower_components/warp10-quantum/warp10-quantum-widget.html">
  -->

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/docs/css/warp10.css">
  <link rel="stylesheet" href="/docs/css/warp10-navbar.css">
  <!-- Pygments Github CSS -->
  <link rel="stylesheet" href="/docs/css/syntax.css">

  <style>
    :host {
      display: block;
    }
    .top-10 { margin-top:10px; }
    h4 {
      font-weight: bold;
    }
    .list-group-item {
      cursor: pointer;
    }
  </style>
</head>

<body>
  
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">

    <div class="navbar-header">
      <!--
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    -->
      <a class="navbar-brand" href="/docs">
        <div class="navbar-id">
          <div class="navbar-id-icon">
            <span id="icon-CityzenData" class="icon-CityzenData"></span>
          </div>
          <div class="navbar-id-name">
            Warp 10
          </div>
        </div>
      </a>
    </div>
    <div class="collapse navbar-nav navbar-collapse navbar-right">
      <div class="form-inline">
        <div class="input-group">
          <div class="input-group-addon"><span class="glyphicon glyphicon-search" aria-hidden="true"></span></div>
          <input id="search_box" class="form-control" style="vertical-align: middle" >
        </div>
      </div>
    </div>
  </div>
</nav>
<div class="navbar-separator" > </div>

<warp10-conf conf="doc"></warp10-conf>

<div id="mainbody">

  <div class="container top-10" id="main-container">
    <div class="row">
      <button type="button" class="navbar-toggle toggle collapsed" data-toggle="collapse" data-target="#sidebar" aria-expanded="false">
  <span class="sr-only">Toggle navigation</span>
  <span class="icon-bar"></span>
  <span class="icon-bar"></span>
  <span class="icon-bar"></span>
</button>
<div id="sidebar" class="col-sm-3 collapse">

  <div class="panel-group" id="side-menu">

    <div id="panel-home" class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a data-toggle="collapse" data-parent="#side-menu" href="#collapse-home">
        <span class="glyphicon glyphicon-home"></span>Home</a>
    </h4>
  </div>
  <div id="collapse-home" class="panel-collapse collapse ">
    <div class="list-group">

      <a class="list-group-item" href="/docs/introduction/platform">Overview</a>

      <a class="list-group-item" href="/docs/introduction/concepts">Concepts</a>

      <a class="list-group-item" href="/docs/introduction/history">History</a>

      <a class="list-group-item" href="/docs/introduction/team">Team</a>

      <a class="list-group-item" href="/docs/introduction/versions">Versions</a>

    </div>

  </div>
</div>


    <div id="panel-howto" class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a data-toggle="collapse" data-parent="#side-menu" href="#collapse-howto">
        <span class="glyphicon glyphicon-education"></span>How-to
      </a>
    </h4>
  </div>
  <div id="collapse-howto" class="panel-collapse collapse  in ">
    <div class="list-group">

      <a class="list-group-item" href="/docs/getting-started">Getting started</a>

      <a class="list-group-item" href="/docs/howto/data-modeling">Data modeling</a>

      <a class="list-group-item" href="/docs/howto/migrate-from">Migrate from</a>
      <div class="list-group-item">Tutorials</div>
      <div class="list-group">
        <a class="list-group-item" href="/docs/howto/intro-bucketize">BUCKETIZE</a>
        <a class="list-group-item" href="/docs/howto/intro-reduce">REDUCE</a>
      </div>

      <a class="list-group-item" href="/docs/howto/pushing-data">Pushing data</a>
      <div class="list-group">
        <a class="list-group-item" href="/docs/howto/websocket-push">Using WebSockets</a>
        <a class="list-group-item" href="/docs/howto/collecting-tools">Using metrics collecting tools</a>
      </div>

      <a class="list-group-item" href="/docs/howto/accessing-data">Accessing data</a>

      <a class="list-group-item" href="/docs/howto/fetching-data">Fetching data</a>

      <a class="list-group-item" href="/docs/howto/create-a-udf">Create and deploy one User Defined Function</a>
      
      <a class="list-group-item" href="/docs/howto/create-a-warpscript-extension">Create a WarpScript extension</a>

      <a class="list-group-item" href="/docs/howto/connect-zeppelin">Connect Warp&nbsp;10 to Apache Zeppelin</a>


      <a class="list-group-item" href="/howto/monitoring-warp-10-using-warp-10">Monitoring Warp&nbsp;10</a>
    </div>

  </div>
</div>


    <div id="panel-tutorial" class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a data-toggle="collapse" data-parent="#side-menu" href="#collapse-apis">
        <span class="glyphicon glyphicon-tasks"></span>APIs
      </a>
    </h4>
  </div>
  <div id="collapse-apis" class="panel-collapse collapse ">
    <div class="list-group">
      <a class="list-group-item" href="/docs/apis/">Overview</a>

      <a class="list-group-item" href="/docs/apis/warpscript">WarpScript</a>

      <a class="list-group-item" href="/docs/apis/fetch">Fetch</a>

      <a class="list-group-item" href="/docs/apis/ingress">Ingress</a>

      <a class="list-group-item" href="/docs/apis/delete">Delete</a>

      <a class="list-group-item" href="/docs/apis/gts-input-format">GTS input format</a>

      <a class="list-group-item" href="/docs/apis/gts-output-format">GTS output format</a>

    </div>

  </div>
</div>


    <div id="panel-reference" class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a data-toggle="collapse" data-parent="#side-menu" href="#collapse-reference">
        <span class="glyphicon glyphicon-cog"></span>WarpScript</a>
    </h4>
  </div>
  <div id="collapse-reference" class="panel-collapse collapse ">
    <div class="list-group">
      <a class="list-group-item" href="/docs/reference/">Overview</a>

      <div class="list-group-item">
        <a href="/docs/reference/reference">Reference</a>
      </div>
      <div class="list-group" id="collapse-reference-list">
        <a class="list-group-item" href="/docs/reference/reference#frameworks">Frameworks</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-constant">Constant</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-math">Mathematical</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-standalone">Standalone</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-lists-maps">Lists &amp; maps</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-logic">Logic</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-stack">Stack</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-platform">Platform</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-gts">Geo Time Series<sup>®</sup></a>
        <a class="list-group-item" href="/docs/reference/reference#functions-bucketized-gts">Bucketized GTS</a>
        <a class="list-group-item" href="/docs/reference/reference#functions-geo">Geo-related</a>
      </div>
      <a class="list-group-item" href="/docs/reference/miscellaneous">Miscellaneous functions</a>
      <a class="list-group-item" href="/docs/reference/processing">Working with Processing</a>
    </div>
  </div>
</div>


    <div id="panel-tools" class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a data-toggle="collapse" data-parent="#side-menu" href="#collapse-tools">
        <span class="glyphicon glyphicon-wrench"></span>Tools</a>
    </h4>
  </div>
  <div id="collapse-tools" class="panel-collapse collapse ">
    <div class="list-group">
      <div class="list-group-item">
        <a href="/tools/github_repositories">Github repositories</a>
      </div>
      <div class="list-group" id="collapse-git-list">
        <a class="list-group-item" href="/tools/github_repositories#Platform">Platform</a>
        <a class="list-group-item" href="/tools/github_repositories#Batch">Batch</a>
        <a class="list-group-item" href="/tools/github_repositories#Stream">Stream</a>
        <a class="list-group-item" href="/tools/github_repositories#Inputs">Input plugins</a>
        <a class="list-group-item" href="/tools/github_repositories#Outputs">Output plugins</a>
        <a class="list-group-item" href="/tools/github_repositories#Interpreters">Interpreters</a>
        <a class="list-group-item" href="/tools/github_repositories#IoT">IoT</a>
        <a class="list-group-item" href="/tools/github_repositories#UDFs">WarpScript UDFs</a>
        <a class="list-group-item" href="/tools/github_repositories#Extensions">WarpScript extensions</a>
        <a class="list-group-item" href="/tools/github_repositories#Websites">Websites</a>
        <a class="list-group-item" href="/tools/github_repositories#External">External contributions</a>
      </div>
      <a class="list-group-item" href="/docs/tools/worf">Worf</a>
      <a class="list-group-item" href="/docs/tools/quantum">Quantum</a>
      <a class="list-group-item" href="/docs/tools/trl">Token Revocation List</a>

    </div>

  </div>
</div>


    <div id="panel-support" class="panel panel-default">
  <div class="panel-heading">
    <h4 class="panel-title">
      <a href="/docs/introduction/support/">
        <span class="glyphicon glyphicon-ok-circle"></span>Support
      </a>
    </h4>
  </div>
</div>



  </div>

</div>

      <div class="col-sm-9">
        <h1>Monitoring Warp&nbsp;10 using Warp&nbsp;10</h1>
        <p>The easiest way to monitor a Warp 10 instance (let’s call it the main Warp 10) 
is to use another Warp 10 instance (the monitoring Warp 10) to gather the 
monitoring metrics from the main one, and then use WarpScript to fetch and 
analyze those metrics.</p>

<h2 id="setup-the-monitoring-warp10-instance">Setup the monitoring Warp 10 instance</h2>

<p>The first thing to do is install the instance of Warp 10 where you will do the 
monitoring, gathering the metrics from the main instance and analyzing them via WarpScript.</p>

<blockquote>
  <p>If needed, look at the <a href="/getting-started">getting started</a> page for the detailed 
instructions to install Warp 10</p>
</blockquote>

<h3 id="generate-monitoring-tokens">Generate monitoring tokens</h3>

<p>The monitoring metrics from the main Warp 10 will we pushed in the monitoring
Warp 10 as any other GTS. As such, before pushing them,
you need to generate both a <code>READ</code> and a <code>WRITE</code> token for the monitoring 
application.</p>

<p>To generate these tokens  you use the <code>worf</code> command via Warp 10 init script.</p>

<pre><code>root@XXX:/opt/warp10-X.Y.Z/bin# ./warp10-standalone.init worf appName ttl(ms)
</code></pre>

<p>Let’s say you choose <code>monitoring</code> as the monitoring application name and you want to 
generate one year (31536000000 ms) valable tokens:</p>

<pre><code>root@XXX:/opt/warp10-X.Y.Z/bin# ./warp10-standalone.init worf monitoring 31536000000
default options loaded from file:/opt/warp10-X.Y.Z/bin/../etc/.conf-standalone.conf.worf
{"read":{"token":"lO5XXXXXXXXXXXXXXXXXXXXDXk","tokenIdent":"606aa9b8f6f47136","ttl":31536000000,"application":"monitoring","owner":"3b8ab607-4aac-4b13-9251-94f152924766","producer":"3b8ab607-4aac-4b13-9251-94f152924766"},"write":{"token":"8D_XXXXXXXXXXXXXXXe7B","tokenIdent":"a219f98201b29e01","ttl":31536000000,"application":"monitoring","owner":"3b8ab607-4aac-4b13-9251-94f152924766","producer":"3b8ab607-4aac-4b13-9251-94f152924766"}}
</code></pre>

<h2 id="installing-sensision">Installing Sensision</h2>

<p>In order to gather the monitoring metrics from the main Warp 10, you only need
to install and configure <a href="https://github.com/cityzendata/sensision">Sensision service</a>
in the main Warp 10 machine.</p>

<blockquote>
  <p>In these documentation page we are going to suppose that you’re using
Warp 10 Standalone. If you are using the distributed mode, you will need
to install Sensision in all the Warp 10 nodes but ideally also on the Kafka 
and HBase machines. The process will soon be described in a separated page.</p>
</blockquote>

<p>The easiest way to setup Sensision service is to use the <em>Sensision init script</em> that 
comes with the <em>Sensision service build</em>. Builds of Sensision are available on 
<a href="https://bintray.com/cityzendata/generic/sensision-service">Bintray</a>. It is the 
recommended method of installation.</p>

<h2 id="running-sensision-service">Running Sensision service</h2>

<p>Untar the Sensision service file.</p>

<pre><code>tar xf sensision-service-X.Y.Z.tar.gz
cd sensision-service-X.Y.Z/bin
</code></pre>

<p>If you already have Warp 10 running, your <code>JAVA_HOME</code> environment variable should 
be already set, but you can also set can set it in the Sensision init script 
<code>sensision.init</code>.</p>

<p>Execute the Sensision init script <code>sensision.init</code>. This script must be run as <strong>root</strong>. 
It will create the folder <code>/var/run/sensision</code> and all the stuff surrounding it. 
Then the init script starts the sensision service with a conf by default.</p>

<pre><code>./sensision.init start
</code></pre>

<pre><code>root@XXX:/opt/sensision-X.Y.Z/bin
Config file does not exist - Creating it from template...
Init Sensision..
Fix permissions..
'WARP10_CONF' is not defined. Skip generation of Sensision configuration - Copy template as it is
Starting is going to be stopped - Update configuration '/opt/sensision-X.Y.Z/bin/../etc/sensision.conf' manually and restart Sensision
</code></pre>

<p>At this moment, Sensision has been only partially initialized, at it lacks the information on the
Warp 10 instance it must push the metrics to. You need to edit the 
<code>/opt/sensision-X.Y.Z/etc/sensision.conf</code> configuration file to set it.</p>

<p>Look at the <em>Default queue</em> part of the configuration file:</p>

<pre><code>#
# Default queue
#

sensision.qf.url.default=http://127.0.0.1:8080/api/v0/update
sensision.qf.token.default=@warp:WriteToken@
sensision.qf.topn.default=250
sensision.qf.period.default=1000
sensision.qf.batchsize.default=100000
#sensision.qf.proxy.host.default=
#sensision.qf.proxy.port.default=
#sensision.dedup.maxsize.default=xxx
#sensision.dedup.maxage.default=xxx
</code></pre>

<p>And set <code>sensision.qf.url.default</code> to the <em>Update</em> endpoint of your monitoring Warp 10 instance, 
and put the monitoring <code>WRITE</code> token you generated before in the <code>sensision.qf.token.default</code> variable.</p>

<p>Then you can restart Sensision:</p>

<pre><code>./sensision.init start
</code></pre>

<p>If everything is ok, you can see that a Sensision target file for your main Warp 10 instance is
created on <code>/var/run/sensision/targets/</code>:</p>

<pre><code>root@XXX:ls -al /var/run/sensision/targets/
total 8
drwx-wx-wt  2 horacio horacio 4096 sept. 27 09:52 .
drwxr-xr-x 10 horacio horacio 4096 juil. 21 16:29 ..
-rw-rw-r--  1 horacio horacio    0 sept. 27 09:52 7ffffea13dad1efc.60000.af4ec5da-f721-493d-aaa0-25b3b8e70d05.38261.target
-rw-rw-r--  1 horacio horacio    0 sept. 27 09:52 7ffffea13dad4e0c.60000.f519167d-c4f7-435f-ae8e-2b87f67b102f.42893.warp.target
</code></pre>

<p>In this example, the target file for your Warp 10 is <code>7ffffea13dad4e0c.60000.f519167d-c4f7-435f-ae8e-2b87f67b102f.42893.warp.target</code>.
The number before <code>.warp.target</code> is the port opened by Warp 10 to expose its metrics, you can manually poll it to 
see if it is working:</p>

<pre><code>root@XXX:curl 127.0.0.1:42893/metrics
1506498948335000// warp.revision{component=standalone} '1.2.10'
1506498948335000// warp.script.mobius.sessions.scheduled{} 0
1506498948335000// warp.script.repository.macros{} 0
1506498948335000// warp.script.repository.jars{} 0
1506498948335000// warp.script.bootstrap.loads{} 6
1506498948335000// warp.script.function.count{function=DEF} 6
1506498948336000// warp.directory.gts{} 458810
1506498948336000// warp.script.function.time.us{function=DEF} 324
</code></pre>

<h2 id="using-the-metrics">Using the metrics</h2>

<p>The complete list of the metrics exposed by Warp 10 is on 
https://github.com/cityzendata/warp10-platform/blob/master/warp10/src/main/java/io/warp10/continuum/sensision/SensisionConstants.java</p>

<p>You can manipulate those metrics in any way you want. Some suggestions :</p>

<ul>
  <li>
    <p>Use <a href="https://github.com/cityzendata/warp10-quantumviz">QuantumViz</a> custom elements and some simple WarpScript 
<code>FETCH</code>s to get and plot the last values of the metrics you want to monitor.</p>
  </li>
  <li>
    <p>Use the <a href="https://github.com/cityzendata/grafana-warp10">Grafana Warp 10 plugin</a> and some WarpScript code to build
a fully featured monitoring dashboard.</p>
  </li>
  <li>
    <p>Make your favorite monitoring tool do some WarpScript requests (they are simple HTTP requests, almost any tool 
is able to do it) to get the metrics and add them to you favorite dashboard or monitoring tool.</p>
  </li>
</ul>


      </div>
    </div>
  </div>
  

<!-- Footer -->
<footer>

  <hr>

  <div id="contact" class="container text-center">
    <!-- Footer -->
    <a class="webicons" href="https://twitter.com/CityzenData" target="_blank">
      <footer>
        <div id="contact" class="container text-center">
      <div class="webicon twitter"></div>
      <div class="webicon_text twitter">@CityzenData</div>
    </a>
    <a class="webicons" href="mailto:contact@cityzendata.com" target="_blank">
      <div class="webicon mail"></div>
      <div class="webicon_text mail">contact@cityzendata.com</div>
    </a>
  </div>

  <div class="container text-center top-margin">
    Copyright &copy; 2016 Cityzen Data
  </div>
  <div class="container text-center">
    <a href="/docs/introduction/legal">Legal</a>
  </div>

</footer>

<script>
    var template = document.querySelector('template[is="dom-bind"]');
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
apiKey: 'e3f0d4e7cfac4e1065a92f60b3ec28d1',
indexName: 'warp10',
inputSelector: '#search_box'
});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-43780642-5', 'auto');
  ga('send', 'pageview');

</script>

<!-- Start of Async Drift Code -->
<script>
!function() {
  var t;
  if (t = window.driftt = window.drift = window.driftt || [], !t.init) return t.invoked ? void (window.console && console.error && console.error("Drift snippet included twice.")) : (t.invoked = !0, 
  t.methods = [ "identify", "config", "track", "reset", "debug", "show", "ping", "page", "hide", "off", "on" ], 
  t.factory = function(e) {
    return function() {
      var n;
      return n = Array.prototype.slice.call(arguments), n.unshift(e), t.push(n), t;
    };
  }, t.methods.forEach(function(e) {
    t[e] = t.factory(e);
  }), t.load = function(t) {
    var e, n, o, i;
    e = 3e5, i = Math.ceil(new Date() / e) * e, o = document.createElement("script"), 
    o.type = "text/javascript", o.async = !0, o.crossorigin = "anonymous", o.src = "https://js.driftt.com/include/" + i + "/" + t + ".js", 
    n = document.getElementsByTagName("script")[0], n.parentNode.insertBefore(o, n);
  });
}();
drift.SNIPPET_VERSION = '0.3.1';
drift.load('pf9x6nb43t24');
</script>
<!-- End of Async Drift Code -->
</body>
</html>
